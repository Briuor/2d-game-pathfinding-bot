(()=>{var t={485:(t,e,i)=>{t.exports=i(894)},894:function(t,e,i){t=i.nmd(t),function(){var e,i,s,n,r,a,o,l,h,u,p,c,d,f,g;s=Math.floor,u=Math.min,i=function(t,e){return t<e?-1:t>e?1:0},h=function(t,e,n,r,a){var o;if(null==n&&(n=0),null==a&&(a=i),n<0)throw new Error("lo must be non-negative");for(null==r&&(r=t.length);n<r;)a(e,t[o=s((n+r)/2)])<0?r=o:n=o+1;return[].splice.apply(t,[n,n-n].concat(e)),e},a=function(t,e,s){return null==s&&(s=i),t.push(e),f(t,0,t.length-1,s)},r=function(t,e){var s,n;return null==e&&(e=i),s=t.pop(),t.length?(n=t[0],t[0]=s,g(t,0,e)):n=s,n},l=function(t,e,s){var n;return null==s&&(s=i),n=t[0],t[0]=e,g(t,0,s),n},o=function(t,e,s){var n;return null==s&&(s=i),t.length&&s(t[0],e)<0&&(e=(n=[t[0],e])[0],t[0]=n[1],g(t,0,s)),e},n=function(t,e){var n,r,a,o,l,h;for(null==e&&(e=i),l=[],r=0,a=(o=function(){h=[];for(var e=0,i=s(t.length/2);0<=i?e<i:e>i;0<=i?e++:e--)h.push(e);return h}.apply(this).reverse()).length;r<a;r++)n=o[r],l.push(g(t,n,e));return l},d=function(t,e,s){var n;if(null==s&&(s=i),-1!==(n=t.indexOf(e)))return f(t,0,n,s),g(t,n,s)},p=function(t,e,s){var r,a,l,h,u;if(null==s&&(s=i),!(a=t.slice(0,e)).length)return a;for(n(a,s),l=0,h=(u=t.slice(e)).length;l<h;l++)r=u[l],o(a,r,s);return a.sort(s).reverse()},c=function(t,e,s){var a,o,l,p,c,d,f,g,b;if(null==s&&(s=i),10*e<=t.length){if(!(l=t.slice(0,e).sort(s)).length)return l;for(o=l[l.length-1],p=0,d=(f=t.slice(e)).length;p<d;p++)s(a=f[p],o)<0&&(h(l,a,0,null,s),l.pop(),o=l[l.length-1]);return l}for(n(t,s),b=[],c=0,g=u(e,t.length);0<=g?c<g:c>g;0<=g?++c:--c)b.push(r(t,s));return b},f=function(t,e,s,n){var r,a,o;for(null==n&&(n=i),r=t[s];s>e&&n(r,a=t[o=s-1>>1])<0;)t[s]=a,s=o;return t[s]=r},g=function(t,e,s){var n,r,a,o,l;for(null==s&&(s=i),r=t.length,l=e,a=t[e],n=2*e+1;n<r;)(o=n+1)<r&&!(s(t[n],t[o])<0)&&(n=o),t[e]=t[n],n=2*(e=n)+1;return t[e]=a,f(t,l,e,s)},e=function(){function t(t){this.cmp=null!=t?t:i,this.nodes=[]}return t.push=a,t.pop=r,t.replace=l,t.pushpop=o,t.heapify=n,t.updateItem=d,t.nlargest=p,t.nsmallest=c,t.prototype.push=function(t){return a(this.nodes,t,this.cmp)},t.prototype.pop=function(){return r(this.nodes,this.cmp)},t.prototype.peek=function(){return this.nodes[0]},t.prototype.contains=function(t){return-1!==this.nodes.indexOf(t)},t.prototype.replace=function(t){return l(this.nodes,t,this.cmp)},t.prototype.pushpop=function(t){return o(this.nodes,t,this.cmp)},t.prototype.heapify=function(){return n(this.nodes,this.cmp)},t.prototype.updateItem=function(t){return d(this.nodes,t,this.cmp)},t.prototype.clear=function(){return this.nodes=[]},t.prototype.empty=function(){return 0===this.nodes.length},t.prototype.size=function(){return this.nodes.length},t.prototype.clone=function(){var e;return(e=new t).nodes=this.nodes.slice(0),e},t.prototype.toArray=function(){return this.nodes.slice(0)},t.prototype.insert=t.prototype.push,t.prototype.top=t.prototype.peek,t.prototype.front=t.prototype.peek,t.prototype.has=t.prototype.contains,t.prototype.copy=t.prototype.clone,t}(),(null!==t?t.exports:void 0)?t.exports=e:window.Heap=e}.call(this)},657:(t,e,i)=>{t.exports=i(558)},558:(t,e,i)=>{t.exports={Heap:i(485),Node:i(289),Grid:i(809),Util:i(408),DiagonalMovement:i(506),Heuristic:i(430),AStarFinder:i(131),BestFirstFinder:i(644),BreadthFirstFinder:i(904),DijkstraFinder:i(607),BiAStarFinder:i(713),BiBestFirstFinder:i(325),BiBreadthFirstFinder:i(513),BiDijkstraFinder:i(511),IDAStarFinder:i(944),JumpPointFinder:i(717)}},506:t=>{t.exports={Always:1,Never:2,IfAtMostOneObstacle:3,OnlyWhenNoObstacles:4}},809:(t,e,i)=>{var s=i(289),n=i(506);function r(t,e,i){var s;"object"!=typeof t?s=t:(e=t.length,s=t[0].length,i=t),this.width=s,this.height=e,this.nodes=this._buildNodes(s,e,i)}r.prototype._buildNodes=function(t,e,i){var n,r,a=new Array(e);for(n=0;n<e;++n)for(a[n]=new Array(t),r=0;r<t;++r)a[n][r]=new s(r,n);if(void 0===i)return a;if(i.length!==e||i[0].length!==t)throw new Error("Matrix size does not fit");for(n=0;n<e;++n)for(r=0;r<t;++r)i[n][r]&&(a[n][r].walkable=!1);return a},r.prototype.getNodeAt=function(t,e){return this.nodes[e][t]},r.prototype.isWalkableAt=function(t,e){return this.isInside(t,e)&&this.nodes[e][t].walkable},r.prototype.isInside=function(t,e){return t>=0&&t<this.width&&e>=0&&e<this.height},r.prototype.setWalkableAt=function(t,e,i){this.nodes[e][t].walkable=i},r.prototype.getNeighbors=function(t,e){var i=t.x,s=t.y,r=[],a=!1,o=!1,l=!1,h=!1,u=!1,p=!1,c=!1,d=!1,f=this.nodes;if(this.isWalkableAt(i,s-1)&&(r.push(f[s-1][i]),a=!0),this.isWalkableAt(i+1,s)&&(r.push(f[s][i+1]),l=!0),this.isWalkableAt(i,s+1)&&(r.push(f[s+1][i]),u=!0),this.isWalkableAt(i-1,s)&&(r.push(f[s][i-1]),c=!0),e===n.Never)return r;if(e===n.OnlyWhenNoObstacles)o=c&&a,h=a&&l,p=l&&u,d=u&&c;else if(e===n.IfAtMostOneObstacle)o=c||a,h=a||l,p=l||u,d=u||c;else{if(e!==n.Always)throw new Error("Incorrect value of diagonalMovement");o=!0,h=!0,p=!0,d=!0}return o&&this.isWalkableAt(i-1,s-1)&&r.push(f[s-1][i-1]),h&&this.isWalkableAt(i+1,s-1)&&r.push(f[s-1][i+1]),p&&this.isWalkableAt(i+1,s+1)&&r.push(f[s+1][i+1]),d&&this.isWalkableAt(i-1,s+1)&&r.push(f[s+1][i-1]),r},r.prototype.clone=function(){var t,e,i=this.width,n=this.height,a=this.nodes,o=new r(i,n),l=new Array(n);for(t=0;t<n;++t)for(l[t]=new Array(i),e=0;e<i;++e)l[t][e]=new s(e,t,a[t][e].walkable);return o.nodes=l,o},t.exports=r},430:t=>{t.exports={manhattan:function(t,e){return t+e},euclidean:function(t,e){return Math.sqrt(t*t+e*e)},octile:function(t,e){var i=Math.SQRT2-1;return t<e?i*t+e:i*e+t},chebyshev:function(t,e){return Math.max(t,e)}}},289:t=>{t.exports=function(t,e,i){this.x=t,this.y=e,this.walkable=void 0===i||i}},408:(t,e)=>{function i(t){for(var e=[[t.x,t.y]];t.parent;)t=t.parent,e.push([t.x,t.y]);return e.reverse()}function s(t,e,i,s){var n,r,a,o,l,h,u=Math.abs,p=[];for(n=t<i?1:-1,r=e<s?1:-1,l=(a=u(i-t))-(o=u(s-e));p.push([t,e]),t!==i||e!==s;)(h=2*l)>-o&&(l-=o,t+=n),h<a&&(l+=a,e+=r);return p}e.backtrace=i,e.biBacktrace=function(t,e){var s=i(t),n=i(e);return s.concat(n.reverse())},e.pathLength=function(t){var e,i,s,n,r,a=0;for(e=1;e<t.length;++e)i=t[e-1],s=t[e],n=i[0]-s[0],r=i[1]-s[1],a+=Math.sqrt(n*n+r*r);return a},e.interpolate=s,e.expandPath=function(t){var e,i,n,r,a,o,l=[],h=t.length;if(h<2)return l;for(a=0;a<h-1;++a)for(e=t[a],i=t[a+1],r=(n=s(e[0],e[1],i[0],i[1])).length,o=0;o<r-1;++o)l.push(n[o]);return l.push(t[h-1]),l},e.smoothenPath=function(t,e){var i,n,r,a,o,l,h,u,p,c=e.length,d=e[0][0],f=e[0][1],g=e[c-1][0],b=e[c-1][1];for(r=[[i=d,n=f]],a=2;a<c;++a){for(h=s(i,n,(l=e[a])[0],l[1]),p=!1,o=1;o<h.length;++o)if(u=h[o],!t.isWalkableAt(u[0],u[1])){p=!0;break}p&&(lastValidCoord=e[a-1],r.push(lastValidCoord),i=lastValidCoord[0],n=lastValidCoord[1])}return r.push([g,b]),r},e.compressPath=function(t){if(t.length<3)return t;var e,i,s,n,r,a,o=[],l=t[0][0],h=t[0][1],u=t[1][0],p=t[1][1],c=u-l,d=p-h;for(c/=r=Math.sqrt(c*c+d*d),d/=r,o.push([l,h]),a=2;a<t.length;a++)e=u,i=p,s=c,n=d,c=(u=t[a][0])-e,d=(p=t[a][1])-i,d/=r=Math.sqrt(c*c+d*d),(c/=r)===s&&d===n||o.push([e,i]);return o.push([u,p]),o}},131:(t,e,i)=>{var s=i(485),n=i(408),r=i(430),a=i(506);function o(t){t=t||{},this.allowDiagonal=t.allowDiagonal,this.dontCrossCorners=t.dontCrossCorners,this.heuristic=t.heuristic||r.manhattan,this.weight=t.weight||1,this.diagonalMovement=t.diagonalMovement,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=a.OnlyWhenNoObstacles:this.diagonalMovement=a.IfAtMostOneObstacle:this.diagonalMovement=a.Never),this.diagonalMovement===a.Never?this.heuristic=t.heuristic||r.manhattan:this.heuristic=t.heuristic||r.octile}o.prototype.findPath=function(t,e,i,r,a){var o,l,h,u,p,c,d,f,g=new s((function(t,e){return t.f-e.f})),b=a.getNodeAt(t,e),y=a.getNodeAt(i,r),m=this.heuristic,v=this.diagonalMovement,A=this.weight,k=Math.abs,W=Math.SQRT2;for(b.g=0,b.f=0,g.push(b),b.opened=!0;!g.empty();){if((o=g.pop()).closed=!0,o===y)return n.backtrace(y);for(u=0,p=(l=a.getNeighbors(o,v)).length;u<p;++u)(h=l[u]).closed||(c=h.x,d=h.y,f=o.g+(c-o.x==0||d-o.y==0?1:W),(!h.opened||f<h.g)&&(h.g=f,h.h=h.h||A*m(k(c-i),k(d-r)),h.f=h.g+h.h,h.parent=o,h.opened?g.updateItem(h):(g.push(h),h.opened=!0)))}return[]},t.exports=o},644:(t,e,i)=>{var s=i(131);function n(t){s.call(this,t);var e=this.heuristic;this.heuristic=function(t,i){return 1e6*e(t,i)}}n.prototype=new s,n.prototype.constructor=n,t.exports=n},713:(t,e,i)=>{var s=i(485),n=i(408),r=i(430),a=i(506);function o(t){t=t||{},this.allowDiagonal=t.allowDiagonal,this.dontCrossCorners=t.dontCrossCorners,this.diagonalMovement=t.diagonalMovement,this.heuristic=t.heuristic||r.manhattan,this.weight=t.weight||1,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=a.OnlyWhenNoObstacles:this.diagonalMovement=a.IfAtMostOneObstacle:this.diagonalMovement=a.Never),this.diagonalMovement===a.Never?this.heuristic=t.heuristic||r.manhattan:this.heuristic=t.heuristic||r.octile}o.prototype.findPath=function(t,e,i,r,a){var o,l,h,u,p,c,d,f,g=function(t,e){return t.f-e.f},b=new s(g),y=new s(g),m=a.getNodeAt(t,e),v=a.getNodeAt(i,r),A=this.heuristic,k=this.diagonalMovement,W=this.weight,w=Math.abs,M=Math.SQRT2;for(m.g=0,m.f=0,b.push(m),m.opened=1,v.g=0,v.f=0,y.push(v),v.opened=2;!b.empty()&&!y.empty();){for((o=b.pop()).closed=!0,u=0,p=(l=a.getNeighbors(o,k)).length;u<p;++u)if(!(h=l[u]).closed){if(2===h.opened)return n.biBacktrace(o,h);c=h.x,d=h.y,f=o.g+(c-o.x==0||d-o.y==0?1:M),(!h.opened||f<h.g)&&(h.g=f,h.h=h.h||W*A(w(c-i),w(d-r)),h.f=h.g+h.h,h.parent=o,h.opened?b.updateItem(h):(b.push(h),h.opened=1))}for((o=y.pop()).closed=!0,u=0,p=(l=a.getNeighbors(o,k)).length;u<p;++u)if(!(h=l[u]).closed){if(1===h.opened)return n.biBacktrace(h,o);c=h.x,d=h.y,f=o.g+(c-o.x==0||d-o.y==0?1:M),(!h.opened||f<h.g)&&(h.g=f,h.h=h.h||W*A(w(c-t),w(d-e)),h.f=h.g+h.h,h.parent=o,h.opened?y.updateItem(h):(y.push(h),h.opened=2))}}return[]},t.exports=o},325:(t,e,i)=>{var s=i(713);function n(t){s.call(this,t);var e=this.heuristic;this.heuristic=function(t,i){return 1e6*e(t,i)}}n.prototype=new s,n.prototype.constructor=n,t.exports=n},513:(t,e,i)=>{var s=i(408),n=i(506);function r(t){t=t||{},this.allowDiagonal=t.allowDiagonal,this.dontCrossCorners=t.dontCrossCorners,this.diagonalMovement=t.diagonalMovement,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=n.OnlyWhenNoObstacles:this.diagonalMovement=n.IfAtMostOneObstacle:this.diagonalMovement=n.Never)}r.prototype.findPath=function(t,e,i,n,r){var a,o,l,h,u,p=r.getNodeAt(t,e),c=r.getNodeAt(i,n),d=[],f=[],g=this.diagonalMovement;for(d.push(p),p.opened=!0,p.by=0,f.push(c),c.opened=!0,c.by=1;d.length&&f.length;){for((l=d.shift()).closed=!0,h=0,u=(a=r.getNeighbors(l,g)).length;h<u;++h)if(!(o=a[h]).closed)if(o.opened){if(1===o.by)return s.biBacktrace(l,o)}else d.push(o),o.parent=l,o.opened=!0,o.by=0;for((l=f.shift()).closed=!0,h=0,u=(a=r.getNeighbors(l,g)).length;h<u;++h)if(!(o=a[h]).closed)if(o.opened){if(0===o.by)return s.biBacktrace(o,l)}else f.push(o),o.parent=l,o.opened=!0,o.by=1}return[]},t.exports=r},511:(t,e,i)=>{var s=i(713);function n(t){s.call(this,t),this.heuristic=function(t,e){return 0}}n.prototype=new s,n.prototype.constructor=n,t.exports=n},904:(t,e,i)=>{var s=i(408),n=i(506);function r(t){t=t||{},this.allowDiagonal=t.allowDiagonal,this.dontCrossCorners=t.dontCrossCorners,this.diagonalMovement=t.diagonalMovement,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=n.OnlyWhenNoObstacles:this.diagonalMovement=n.IfAtMostOneObstacle:this.diagonalMovement=n.Never)}r.prototype.findPath=function(t,e,i,n,r){var a,o,l,h,u,p=[],c=this.diagonalMovement,d=r.getNodeAt(t,e),f=r.getNodeAt(i,n);for(p.push(d),d.opened=!0;p.length;){if((l=p.shift()).closed=!0,l===f)return s.backtrace(f);for(h=0,u=(a=r.getNeighbors(l,c)).length;h<u;++h)(o=a[h]).closed||o.opened||(p.push(o),o.opened=!0,o.parent=l)}return[]},t.exports=r},607:(t,e,i)=>{var s=i(131);function n(t){s.call(this,t),this.heuristic=function(t,e){return 0}}n.prototype=new s,n.prototype.constructor=n,t.exports=n},944:(t,e,i)=>{i(408);var s=i(430),n=i(289),r=i(506);function a(t){t=t||{},this.allowDiagonal=t.allowDiagonal,this.dontCrossCorners=t.dontCrossCorners,this.diagonalMovement=t.diagonalMovement,this.heuristic=t.heuristic||s.manhattan,this.weight=t.weight||1,this.trackRecursion=t.trackRecursion||!1,this.timeLimit=t.timeLimit||1/0,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=r.OnlyWhenNoObstacles:this.diagonalMovement=r.IfAtMostOneObstacle:this.diagonalMovement=r.Never),this.diagonalMovement===r.Never?this.heuristic=t.heuristic||s.manhattan:this.heuristic=t.heuristic||s.octile}a.prototype.findPath=function(t,e,i,s,r){var a,o,l,h=(new Date).getTime(),u=function(t,e){return this.heuristic(Math.abs(e.x-t.x),Math.abs(e.y-t.y))}.bind(this),p=function(t,e,i,s,a){if(this.timeLimit>0&&(new Date).getTime()-h>1e3*this.timeLimit)return 1/0;var o,l,c,f,g=e+u(t,d)*this.weight;if(g>i)return g;if(t==d)return s[a]=[t.x,t.y],t;var b,y,m=r.getNeighbors(t,this.diagonalMovement);for(c=0,o=1/0;f=m[c];++c){if(this.trackRecursion&&(f.retainCount=f.retainCount+1||1,!0!==f.tested&&(f.tested=!0)),(l=p(f,e+(y=f,(b=t).x===y.x||b.y===y.y?1:Math.SQRT2),i,s,a+1))instanceof n)return s[a]=[t.x,t.y],l;this.trackRecursion&&0==--f.retainCount&&(f.tested=!1),l<o&&(o=l)}return o}.bind(this),c=r.getNodeAt(t,e),d=r.getNodeAt(i,s),f=u(c,d);for(a=0;;++a){if((l=p(c,0,f,o=[],0))===1/0)return[];if(l instanceof n)return o;f=l}return[]},t.exports=a},524:(t,e,i)=>{var s=i(10),n=i(506);function r(t){s.call(this,t)}r.prototype=new s,r.prototype.constructor=r,r.prototype._jump=function(t,e,i,s){var n=this.grid,r=t-i,a=e-s;if(!n.isWalkableAt(t,e))return null;if(!0===this.trackJumpRecursion&&(n.getNodeAt(t,e).tested=!0),n.getNodeAt(t,e)===this.endNode)return[t,e];if(0!==r&&0!==a){if(n.isWalkableAt(t-r,e+a)&&!n.isWalkableAt(t-r,e)||n.isWalkableAt(t+r,e-a)&&!n.isWalkableAt(t,e-a))return[t,e];if(this._jump(t+r,e,t,e)||this._jump(t,e+a,t,e))return[t,e]}else if(0!==r){if(n.isWalkableAt(t+r,e+1)&&!n.isWalkableAt(t,e+1)||n.isWalkableAt(t+r,e-1)&&!n.isWalkableAt(t,e-1))return[t,e]}else if(n.isWalkableAt(t+1,e+a)&&!n.isWalkableAt(t+1,e)||n.isWalkableAt(t-1,e+a)&&!n.isWalkableAt(t-1,e))return[t,e];return this._jump(t+r,e+a,t,e)},r.prototype._findNeighbors=function(t){var e,i,s,r,a,o,l,h,u=t.parent,p=t.x,c=t.y,d=this.grid,f=[];if(u)e=u.x,i=u.y,s=(p-e)/Math.max(Math.abs(p-e),1),r=(c-i)/Math.max(Math.abs(c-i),1),0!==s&&0!==r?(d.isWalkableAt(p,c+r)&&f.push([p,c+r]),d.isWalkableAt(p+s,c)&&f.push([p+s,c]),d.isWalkableAt(p+s,c+r)&&f.push([p+s,c+r]),d.isWalkableAt(p-s,c)||f.push([p-s,c+r]),d.isWalkableAt(p,c-r)||f.push([p+s,c-r])):0===s?(d.isWalkableAt(p,c+r)&&f.push([p,c+r]),d.isWalkableAt(p+1,c)||f.push([p+1,c+r]),d.isWalkableAt(p-1,c)||f.push([p-1,c+r])):(d.isWalkableAt(p+s,c)&&f.push([p+s,c]),d.isWalkableAt(p,c+1)||f.push([p+s,c+1]),d.isWalkableAt(p,c-1)||f.push([p+s,c-1]));else for(l=0,h=(a=d.getNeighbors(t,n.Always)).length;l<h;++l)o=a[l],f.push([o.x,o.y]);return f},t.exports=r},405:(t,e,i)=>{var s=i(10),n=i(506);function r(t){s.call(this,t)}r.prototype=new s,r.prototype.constructor=r,r.prototype._jump=function(t,e,i,s){var n=this.grid,r=t-i,a=e-s;if(!n.isWalkableAt(t,e))return null;if(!0===this.trackJumpRecursion&&(n.getNodeAt(t,e).tested=!0),n.getNodeAt(t,e)===this.endNode)return[t,e];if(0!==r&&0!==a){if(n.isWalkableAt(t-r,e+a)&&!n.isWalkableAt(t-r,e)||n.isWalkableAt(t+r,e-a)&&!n.isWalkableAt(t,e-a))return[t,e];if(this._jump(t+r,e,t,e)||this._jump(t,e+a,t,e))return[t,e]}else if(0!==r){if(n.isWalkableAt(t+r,e+1)&&!n.isWalkableAt(t,e+1)||n.isWalkableAt(t+r,e-1)&&!n.isWalkableAt(t,e-1))return[t,e]}else if(n.isWalkableAt(t+1,e+a)&&!n.isWalkableAt(t+1,e)||n.isWalkableAt(t-1,e+a)&&!n.isWalkableAt(t-1,e))return[t,e];return n.isWalkableAt(t+r,e)||n.isWalkableAt(t,e+a)?this._jump(t+r,e+a,t,e):null},r.prototype._findNeighbors=function(t){var e,i,s,r,a,o,l,h,u=t.parent,p=t.x,c=t.y,d=this.grid,f=[];if(u)e=u.x,i=u.y,s=(p-e)/Math.max(Math.abs(p-e),1),r=(c-i)/Math.max(Math.abs(c-i),1),0!==s&&0!==r?(d.isWalkableAt(p,c+r)&&f.push([p,c+r]),d.isWalkableAt(p+s,c)&&f.push([p+s,c]),(d.isWalkableAt(p,c+r)||d.isWalkableAt(p+s,c))&&f.push([p+s,c+r]),!d.isWalkableAt(p-s,c)&&d.isWalkableAt(p,c+r)&&f.push([p-s,c+r]),!d.isWalkableAt(p,c-r)&&d.isWalkableAt(p+s,c)&&f.push([p+s,c-r])):0===s?d.isWalkableAt(p,c+r)&&(f.push([p,c+r]),d.isWalkableAt(p+1,c)||f.push([p+1,c+r]),d.isWalkableAt(p-1,c)||f.push([p-1,c+r])):d.isWalkableAt(p+s,c)&&(f.push([p+s,c]),d.isWalkableAt(p,c+1)||f.push([p+s,c+1]),d.isWalkableAt(p,c-1)||f.push([p+s,c-1]));else for(l=0,h=(a=d.getNeighbors(t,n.IfAtMostOneObstacle)).length;l<h;++l)o=a[l],f.push([o.x,o.y]);return f},t.exports=r},368:(t,e,i)=>{var s=i(10),n=i(506);function r(t){s.call(this,t)}r.prototype=new s,r.prototype.constructor=r,r.prototype._jump=function(t,e,i,s){var n=this.grid,r=t-i,a=e-s;if(!n.isWalkableAt(t,e))return null;if(!0===this.trackJumpRecursion&&(n.getNodeAt(t,e).tested=!0),n.getNodeAt(t,e)===this.endNode)return[t,e];if(0!==r&&0!==a){if(this._jump(t+r,e,t,e)||this._jump(t,e+a,t,e))return[t,e]}else if(0!==r){if(n.isWalkableAt(t,e-1)&&!n.isWalkableAt(t-r,e-1)||n.isWalkableAt(t,e+1)&&!n.isWalkableAt(t-r,e+1))return[t,e]}else if(0!==a&&(n.isWalkableAt(t-1,e)&&!n.isWalkableAt(t-1,e-a)||n.isWalkableAt(t+1,e)&&!n.isWalkableAt(t+1,e-a)))return[t,e];return n.isWalkableAt(t+r,e)&&n.isWalkableAt(t,e+a)?this._jump(t+r,e+a,t,e):null},r.prototype._findNeighbors=function(t){var e,i,s,r,a,o,l,h,u,p=t.parent,c=t.x,d=t.y,f=this.grid,g=[];if(p){if(e=p.x,i=p.y,s=(c-e)/Math.max(Math.abs(c-e),1),r=(d-i)/Math.max(Math.abs(d-i),1),0!==s&&0!==r)f.isWalkableAt(c,d+r)&&g.push([c,d+r]),f.isWalkableAt(c+s,d)&&g.push([c+s,d]),f.isWalkableAt(c,d+r)&&f.isWalkableAt(c+s,d)&&g.push([c+s,d+r]);else if(0!==s){u=f.isWalkableAt(c+s,d);var b=f.isWalkableAt(c,d+1),y=f.isWalkableAt(c,d-1);u&&(g.push([c+s,d]),b&&g.push([c+s,d+1]),y&&g.push([c+s,d-1])),b&&g.push([c,d+1]),y&&g.push([c,d-1])}else if(0!==r){u=f.isWalkableAt(c,d+r);var m=f.isWalkableAt(c+1,d),v=f.isWalkableAt(c-1,d);u&&(g.push([c,d+r]),m&&g.push([c+1,d+r]),v&&g.push([c-1,d+r])),m&&g.push([c+1,d]),v&&g.push([c-1,d])}}else for(l=0,h=(a=f.getNeighbors(t,n.OnlyWhenNoObstacles)).length;l<h;++l)o=a[l],g.push([o.x,o.y]);return g},t.exports=r},403:(t,e,i)=>{var s=i(10),n=i(506);function r(t){s.call(this,t)}r.prototype=new s,r.prototype.constructor=r,r.prototype._jump=function(t,e,i,s){var n=this.grid,r=t-i,a=e-s;if(!n.isWalkableAt(t,e))return null;if(!0===this.trackJumpRecursion&&(n.getNodeAt(t,e).tested=!0),n.getNodeAt(t,e)===this.endNode)return[t,e];if(0!==r){if(n.isWalkableAt(t,e-1)&&!n.isWalkableAt(t-r,e-1)||n.isWalkableAt(t,e+1)&&!n.isWalkableAt(t-r,e+1))return[t,e]}else{if(0===a)throw new Error("Only horizontal and vertical movements are allowed");if(n.isWalkableAt(t-1,e)&&!n.isWalkableAt(t-1,e-a)||n.isWalkableAt(t+1,e)&&!n.isWalkableAt(t+1,e-a))return[t,e];if(this._jump(t+1,e,t,e)||this._jump(t-1,e,t,e))return[t,e]}return this._jump(t+r,e+a,t,e)},r.prototype._findNeighbors=function(t){var e,i,s,r,a,o,l,h,u=t.parent,p=t.x,c=t.y,d=this.grid,f=[];if(u)e=u.x,i=u.y,s=(p-e)/Math.max(Math.abs(p-e),1),r=(c-i)/Math.max(Math.abs(c-i),1),0!==s?(d.isWalkableAt(p,c-1)&&f.push([p,c-1]),d.isWalkableAt(p,c+1)&&f.push([p,c+1]),d.isWalkableAt(p+s,c)&&f.push([p+s,c])):0!==r&&(d.isWalkableAt(p-1,c)&&f.push([p-1,c]),d.isWalkableAt(p+1,c)&&f.push([p+1,c]),d.isWalkableAt(p,c+r)&&f.push([p,c+r]));else for(l=0,h=(a=d.getNeighbors(t,n.Never)).length;l<h;++l)o=a[l],f.push([o.x,o.y]);return f},t.exports=r},717:(t,e,i)=>{var s=i(506),n=i(403),r=i(524),a=i(368),o=i(405);t.exports=function(t){return(t=t||{}).diagonalMovement===s.Never?new n(t):t.diagonalMovement===s.Always?new r(t):t.diagonalMovement===s.OnlyWhenNoObstacles?new a(t):new o(t)}},10:(t,e,i)=>{var s=i(485),n=i(408),r=i(430);function a(t){t=t||{},this.heuristic=t.heuristic||r.manhattan,this.trackJumpRecursion=t.trackJumpRecursion||!1}i(506),a.prototype.findPath=function(t,e,i,r,a){var o,l=this.openList=new s((function(t,e){return t.f-e.f})),h=this.startNode=a.getNodeAt(t,e),u=this.endNode=a.getNodeAt(i,r);for(this.grid=a,h.g=0,h.f=0,l.push(h),h.opened=!0;!l.empty();){if((o=l.pop()).closed=!0,o===u)return n.expandPath(n.backtrace(u));this._identifySuccessors(o)}return[]},a.prototype._identifySuccessors=function(t){var e,i,s,n,a,o,l,h,u,p,c=this.grid,d=this.heuristic,f=this.openList,g=this.endNode.x,b=this.endNode.y,y=t.x,m=t.y,v=Math.abs;for(Math.max,n=0,a=(e=this._findNeighbors(t)).length;n<a;++n)if(i=e[n],s=this._jump(i[0],i[1],y,m)){if(o=s[0],l=s[1],(p=c.getNodeAt(o,l)).closed)continue;h=r.octile(v(o-y),v(l-m)),u=t.g+h,(!p.opened||u<p.g)&&(p.g=u,p.h=p.h||d(v(o-g),v(l-b)),p.f=p.g+p.h,p.parent=t,p.opened?f.updateItem(p):(f.push(p),p.opened=!0))}},t.exports=a}},e={};function i(s){var n=e[s];if(void 0!==n)return n.exports;var r=e[s]={id:s,loaded:!1,exports:{}};return t[s].call(r.exports,r,r.exports,i),r.loaded=!0,r.exports}i.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{"use strict";class t{constructor(t,e,i,s,n="red"){this.x=t,this.y=e,this.w=i,this.h=s,this.color=n}draw(t){t.fillStyle=this.color,t.beginPath(),t.arc(this.x,this.y,10,0,2*Math.PI),t.fill()}}class e extends t{constructor(t,e,i,s){super(t,e,i,s,"white")}move(t,e){t&&(this.x=t.x,this.y=t.y)}}class s extends t{constructor(t,e,i,s){super(t,e,i,s,"black"),this.speed=8}lerp(t,e,i){return(1-i)*t+i*e}move(t,e,i){let s=20*e[0]-this.x,n=20*e[1]-this.y;console.log(s,n),this.x+=s*this.speed*i,this.y+=n*this.speed*i}}var n=i(657);class r{constructor(){this.tilemap=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,1,1,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,1,1,0,0,0,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,1,0,0,0,0,0,0,0,0,0],[0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],this.grid=new n.Grid(this.tilemap),this.finder=new n.AStarFinder,this.tileSize=20}findPath(t,e,i,s){return this.grid=this.grid.clone(),this.finder.findPath(Math.floor(t/this.tileSize),Math.floor(e/this.tileSize),Math.floor(i/this.tileSize),Math.floor(s/this.tileSize),this.grid)}draw(t){this.tilemap.forEach(((e,i)=>{e.forEach(((e,s)=>{0==e?(t.fillStyle="#252525",t.fillRect(s*this.tileSize,i*this.tileSize,this.tileSize,this.tileSize)):(t.fillStyle="#ff0000",t.fillRect(s*this.tileSize,i*this.tileSize,this.tileSize,this.tileSize))}))}))}drawPath(t,e){e.forEach((e=>{t.fillStyle="lightblue",t.beginPath(),t.arc(20*(e[0]+.5),20*(e[1]+.5),5,0,2*Math.PI),t.fill()}))}}(new class{constructor(){this.canvas=document.getElementById("canvas"),this.canvas.width=window.innerWidth-4,this.canvas.height=window.innerHeight-4,this.ctx=canvas.getContext("2d"),this.map=new r,this.player=new e(2*this.map.tileSize,3*this.map.tileSize,this.map.tileSize,this.map.tileSize),this.enemy=new s(8*this.map.tileSize,3*this.map.tileSize,this.map.tileSize,this.map.tileSize),this.mouse=null,this.initInputListener(this)}initInputListener(t){document.addEventListener("click",(e=>{var i=this.canvas.getBoundingClientRect();t.player.x=Math.floor(e.clientX-i.left),t.player.y=Math.floor(e.clientY-i.top)}))}update(){let t=Date.now(),e=(t-this.lastUpdate)/1e3;this.lastUpdate=t;const i=this.map.findPath(this.enemy.x,this.enemy.y,this.player.x,this.player.y);this.path=i,i.length>=2&&this.enemy.move([i[0][0]+.5,i[0][1]+.5],[i[1][0]+.5,i[1][1]+.5],e)}render(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.map.draw(this.ctx),this.map.drawPath(this.ctx,this.path||[]),this.player.draw(this.ctx),this.enemy.draw(this.ctx)}run(){this.update(),this.render()}start(){this.lastUpdate=Date.now(),setInterval(this.run.bind(this),1e3/60)}}).start()})()})();